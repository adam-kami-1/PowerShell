PowerShell
========================================

Usefull PowerShell scripts.


Following scripts are available for now:



Show-Xml.ps1
----------------------------------------

Display the contents of XML file.

### Syntax

Show-Xml.ps1 [-Depth <Int32>] [-InputObject] <PSObject> [-Tree <String>] [-Width <Int32>] [<CommonParameters>]




Set of scripts allowing to build and run simple menu
----------------------------------------

### Menu-Init.ps1

### Menu-AddItem.ps1

### Menu-Select.ps1

### Menu-Clear.ps1



Library.ps1
----------------------------------------

Set of usefull functions.

To be loaded in a profile:

``` PowerShell
. ...\Library.ps1
```


### Functions defined in Library.ps1:

#### Help()

Better improved version of default PowerShell Help function.

It uses less instead of more.

Because browsing a help file is very easy under less, this version of Help forces using
-Full parameter over -Detailed, -Examples, and -Parameter.

You can still use parameter -Parameter together with positional parameter -Name containing
wildcard specification of help item. This way you can list cmdlets using specific parameter.

If you call Help with one of parameterts -Online or -ShowWindow, then it behaves as standard Get-Help.



pomoc.ps1
----------------------------------------

Version still under construction. Replacement for cmdlet Get-Help

### Issues in original Get-Help to be solved by my own solution:

- [X] When text is longer than the available screen width, then in console version text is broken even inside word.
- [X] When text is longer than the available screen width, then in window (-ShowWindow) version text is broken on word boundaries but indentation is lost. IMHO next lines should be indented like the first one, or in some cases hanging paragraph should be used.
- [ ] Aliases for cmdlets are not shown in cmdlet help.
- [X] Aliases for parameter names should be displayed, when their definition is present in MAML file.
- [X] In section Outputs, there is missing indentation of return value description in window version. In console version works better.
- [X] Missing section header for Examples in console version. Example titles and example contents are not indented.
- [ ] HelpFiles about_* are displayed as a pure text files, without any formatting. So in narrow console/windows they look messy, and in wide they look strange.

### Things that are not an issue, but some prettifying can be easy done (IMHO):

- [X] Lists should be displayed without empty lines separating usually paragraphs. E.g. See the list of acceptable values for parameter -Category in Get-Help.
- [X] The contents of the example should be indented, so example titles can be seen easier.
- [X] The example contents should be separated with emply line from the next example title.

### Issues to be solved in my implementation:
- [ ] Common parameters in Syntax section.
- [ ] Displaying of about_* HelpFiles.
- [ ] Displaying autogenerated help for external scripts.
- [ ] Displaying autogenerated help for functions.


Using less under PowerShell
----------------------------------------

Some argue that archeologists have discovered 'more' between ancient Egyptian artefacts.

Version of less.exe available with Git for Windows from https://git-scm.com/ works pretty well
under PowerShell. To use it under PowerShell you need to define an alias

``` PowerShell
New-Alias less 'C:\Git\usr\bin\less.exe'
```

The above example assumes that Git was installed in `C:\Git`.

If you have not defined it in Windows environment you can define also an environment variable:

``` PowerShell
$env:LESS = '-MRi'
```

M - Causes less to prompt even more verbosely than more.
R - ANSI "color" escape sequences are output in "raw" form.
i - Causes searches to ignore case. If a pattern contains uppercase letters, then that search does not ignore case.


